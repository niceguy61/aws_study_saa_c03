# Day 4-6: 일일 정리 & Q&A

## 📚 학습 목표
- VPC 네트워킹 전체 개념 정리 및 복습
- 3-tier 아키텍처 네트워크 설계 과제 수행
- 실습 내용 종합 정리 및 문제 해결
- 질의응답을 통한 이해도 점검

---

## 📋 VPC 네트워킹 개념 확인 퀴즈 (30분)

### 퀴즈 1: 기본 개념 (5문항)

#### Q1. VPC CIDR 블록 관련
```
다음 중 VPC CIDR 블록으로 사용할 수 없는 것은?
A) 10.0.0.0/16
B) 172.16.0.0/12
C) 192.168.0.0/16
D) 8.8.8.0/24

정답: D
해설: 8.8.8.0/24는 구글의 퍼블릭 DNS 서비스 대역으로 사설 IP 대역이 아닙니다.
VPC에서는 RFC 1918에 정의된 사설 IP 대역만 사용 가능합니다.
```

#### Q2. 서브넷 유형 구분
```
프라이빗 서브넷의 특징으로 올바른 것은?
A) 인터넷 게이트웨이로 직접 라우팅됨
B) 퍼블릭 IP가 자동으로 할당됨
C) NAT 게이트웨이를 통해서만 인터넷 접근 가능
D) 보안 그룹 설정이 불가능함

정답: C
해설: 프라이빗 서브넷은 인터넷 게이트웨이로 직접 라우팅되지 않으며,
외부 인터넷 접근이 필요한 경우 NAT 게이트웨이를 통해서만 가능합니다.
```

#### Q3. 라우팅 우선순위
```
다음 라우팅 테이블에서 10.0.1.100으로 가는 패킷의 경로는?
- 10.0.0.0/16 → local
- 10.0.1.0/24 → nat-gateway
- 0.0.0.0/0 → internet-gateway

A) local
B) nat-gateway  
C) internet-gateway
D) 라우팅 불가능

정답: B
해설: Longest Prefix Match 원칙에 따라 가장 구체적인 경로인
10.0.1.0/24 → nat-gateway가 선택됩니다.
```

#### Q4. NAT 게이트웨이 vs NAT 인스턴스
```
NAT 게이트웨이의 장점이 아닌 것은?
A) AWS 완전 관리형 서비스
B) 자동 스케일링 지원
C) 포트 포워딩 지원
D) 고가용성 자동 보장

정답: C
해설: NAT 게이트웨이는 포트 포워딩을 지원하지 않습니다.
포트 포워딩이 필요한 경우 NAT 인스턴스를 사용해야 합니다.
```

#### Q5. VPC 피어링 제한사항
```
VPC 피어링의 제한사항으로 올바른 것은?
A) 같은 리전 내에서만 가능
B) 전이적 라우팅 지원
C) CIDR 블록 중복 허용
D) 1:1 연결만 가능

정답: D
해설: VPC 피어링은 두 VPC 간의 1:1 직접 연결만 가능하며,
전이적 라우팅(A-B-C 연결 시 A-C 직접 통신)은 지원하지 않습니다.
```

### 퀴즈 2: 실무 시나리오 (5문항)

#### Q6. 보안 그룹 vs NACL
```
다음 상황에서 트래픽이 차단되는 이유는?
- 보안 그룹: HTTP(80) 허용
- NACL: HTTP(80) 인바운드 허용, 아웃바운드 모든 포트 차단
- 클라이언트가 웹 서버에 HTTP 요청

A) 보안 그룹에서 차단
B) NACL에서 차단
C) 정상 통신됨
D) 라우팅 문제

정답: B
해설: NACL은 Stateless이므로 응답 트래픽을 위한 아웃바운드 규칙이 필요합니다.
HTTP 응답은 임시 포트(1024-65535)를 사용하므로 해당 포트가 허용되어야 합니다.
```

#### Q7. 하이브리드 연결 선택
```
다음 요구사항에 가장 적합한 연결 방식은?
- 대역폭: 5Gbps 이상
- 일관된 성능 필요
- 미션 크리티컬 애플리케이션
- 예산 제약 없음

A) Site-to-Site VPN
B) Direct Connect
C) Client VPN
D) VPC 피어링

정답: B
해설: 높은 대역폭과 일관된 성능이 필요한 미션 크리티컬 환경에서는
Direct Connect가 가장 적합합니다.
```

#### Q8. 비용 최적화
```
프라이빗 서브넷에서 S3 접근 시 NAT 비용을 절약하는 방법은?
A) 인터넷 게이트웨이 직접 연결
B) VPC 엔드포인트 사용
C) Direct Connect 사용
D) 퍼블릭 서브넷으로 이동

정답: B
해설: S3 Gateway Endpoint를 사용하면 NAT 게이트웨이를 거치지 않고
프라이빗 서브넷에서 S3에 직접 접근할 수 있어 비용을 절약할 수 있습니다.
```

#### Q9. 고가용성 설계
```
다중 AZ 환경에서 NAT 게이트웨이 고가용성 설계 방법은?
A) 하나의 AZ에 여러 NAT 게이트웨이 배치
B) 각 AZ마다 NAT 게이트웨이 배치
C) 모든 AZ가 하나의 NAT 게이트웨이 공유
D) NAT 인스턴스로 대체

정답: B
해설: 각 AZ마다 NAT 게이트웨이를 배치하고 해당 AZ의 프라이빗 서브넷이
같은 AZ의 NAT 게이트웨이를 사용하도록 설정하는 것이 최적입니다.
```

#### Q10. 트러블슈팅
```
VPC 피어링 연결 후 통신이 안 되는 경우 확인할 사항이 아닌 것은?
A) 라우팅 테이블에 피어링 경로 추가
B) 보안 그룹에서 상대방 CIDR 허용
C) 인터넷 게이트웨이 연결 상태
D) CIDR 블록 중복 여부

정답: C
해설: VPC 피어링은 프라이빗 연결이므로 인터넷 게이트웨이와는 무관합니다.
라우팅 테이블, 보안 그룹, CIDR 중복 여부를 확인해야 합니다.
```

---

## 🏗️ 3-tier 아키텍처 네트워크 설계 과제 (45분)

### 과제 시나리오

#### 비즈니스 요구사항
```
회사: 온라인 쇼핑몰 스타트업
서비스: 웹 기반 전자상거래 플랫폼

기술 요구사항:
- 웹 서버: 고가용성, 오토 스케일링
- 애플리케이션 서버: 보안 강화, 외부 API 호출 필요
- 데이터베이스: 고가용성, 백업, 보안

비기능 요구사항:
- 가용성: 99.9% 이상
- 보안: PCI DSS 준수 수준
- 성능: 응답시간 2초 이내
- 확장성: 트래픽 10배 증가 대응
```

### 설계 과제

#### 1단계: 네트워크 아키텍처 설계
```
설계 요소:
1. VPC CIDR 블록 선택 및 근거
2. 서브넷 설계 (퍼블릭, 프라이빗, DB)
3. 가용 영역 배치 전략
4. 라우팅 테이블 설계
5. NAT 게이트웨이 배치 전략

제출 형식:
- 네트워크 다이어그램
- IP 주소 할당 계획서
- 라우팅 테이블 명세서
- 보안 그룹 규칙 정의서
```

#### 2단계: 보안 설계
```
보안 요구사항:
1. 계층별 보안 그룹 설계
2. 네트워크 ACL 정책
3. 최소 권한 원칙 적용
4. 외부 접근 제어

고려사항:
- 웹 서버: 인터넷에서 HTTP/HTTPS 접근
- 앱 서버: 웹 서버에서만 접근, 외부 API 호출 필요
- DB 서버: 앱 서버에서만 접근, 인터넷 접근 차단
```

#### 3단계: 고가용성 설계
```
고가용성 요구사항:
1. 다중 AZ 배치
2. 로드 밸런서 구성
3. 자동 장애 조치
4. 백업 및 복구 전략

설계 고려사항:
- 단일 장애점 제거
- 자동 복구 메커니즘
- 모니터링 및 알림
- 재해 복구 계획
```

### 설계 템플릿

#### 네트워크 설계 템플릿
```
VPC 설계:
- VPC CIDR: _______________
- 선택 근거: _______________

서브넷 설계:
AZ-A:
- 퍼블릭: _______________
- 프라이빗: _______________  
- DB: _______________

AZ-B:
- 퍼블릭: _______________
- 프라이빗: _______________
- DB: _______________

AZ-C:
- 퍼블릭: _______________
- 프라이빗: _______________
- DB: _______________

라우팅 설계:
- 퍼블릭 RT: _______________
- 프라이빗 RT: _______________
- DB RT: _______________
```

#### 보안 그룹 템플릿
```
웹 서버 보안 그룹:
인바운드:
- HTTP (80): 0.0.0.0/0
- HTTPS (443): 0.0.0.0/0
- SSH (22): [관리자 IP]

아웃바운드:
- 모든 트래픽: 0.0.0.0/0

애플리케이션 서버 보안 그룹:
인바운드:
- HTTP (8080): [웹 서버 보안 그룹]
- SSH (22): [관리자 IP]

아웃바운드:
- HTTPS (443): 0.0.0.0/0 (외부 API)
- MySQL (3306): [DB 보안 그룹]

데이터베이스 보안 그룹:
인바운드:
- MySQL (3306): [앱 서버 보안 그룹]

아웃바운드:
- 없음 (기본 거부)
```

---

## 🔧 실습 내용 종합 정리 (30분)

### 오늘 구축한 인프라 점검

#### 생성된 리소스 확인
```
VPC 리소스:
✅ SAA-Study-VPC (10.0.0.0/16)
✅ 서브넷 9개 (퍼블릭 3개, 프라이빗 3개, DB 3개)
✅ 인터넷 게이트웨이 1개
✅ NAT 게이트웨이 2개 (AZ-A, AZ-B)
✅ 라우팅 테이블 5개

연결 리소스:
✅ VPC 피어링 연결 (테스트용)
✅ Site-to-Site VPN 연결 (데모용)
✅ Customer Gateway
✅ Virtual Private Gateway

테스트 인스턴스:
✅ 퍼블릭 서브넷 인스턴스
✅ 프라이빗 서브넷 인스턴스
✅ 보안 그룹 설정
```

#### 네트워크 흐름 검증
```
트래픽 흐름 테스트:
1. 인터넷 → 퍼블릭 서브넷 ✅
2. 퍼블릭 서브넷 → 프라이빗 서브넷 ✅
3. 프라이빗 서브넷 → 인터넷 (NAT 경유) ✅
4. VPC 간 통신 (피어링) ✅

보안 검증:
1. 프라이빗 서브넷 직접 인터넷 접근 차단 ✅
2. 보안 그룹 규칙 적용 ✅
3. 네트워크 ACL 기본 설정 ✅
```

### 문제 해결 가이드

#### 일반적인 문제와 해결책
```
문제 1: 프라이빗 인스턴스 인터넷 접근 불가
해결책:
- NAT 게이트웨이 생성 확인
- 라우팅 테이블에 0.0.0.0/0 → NAT 경로 추가
- 보안 그룹에서 아웃바운드 트래픽 허용

문제 2: VPC 간 통신 불가 (피어링)
해결책:
- 피어링 연결 상태 확인 (Active)
- 양쪽 라우팅 테이블에 상대방 CIDR 경로 추가
- 보안 그룹에서 상대방 CIDR 허용
- CIDR 블록 중복 여부 확인

문제 3: VPN 연결 불안정
해결책:
- 터널 상태 확인 (최소 1개 UP)
- BGP 세션 상태 확인
- 라우팅 전파 설정 확인
- 방화벽 설정 점검
```

#### 성능 최적화 팁
```
네트워크 성능 향상:
1. 배치 그룹 활용
   - 클러스터 배치 그룹: 고성능 컴퓨팅
   - 파티션 배치 그룹: 분산 워크로드

2. Enhanced Networking 활성화
   - SR-IOV 지원 인스턴스 타입 선택
   - 네트워크 성능 최적화

3. 적절한 인스턴스 크기 선택
   - 네트워크 성능과 인스턴스 크기 비례
   - 워크로드에 맞는 최적 크기 선택
```

---

## ❓ 질의응답 및 문제 해결 (15분)

### 자주 묻는 질문

#### Q1: CIDR 블록 크기를 어떻게 결정하나요?
```
A: CIDR 블록 크기 결정 요소:

현재 요구사항:
- 필요한 인스턴스 수
- 서브넷 개수
- 서비스 유형

미래 확장성:
- 예상 성장률
- 새로운 서비스 추가 계획
- 다른 VPC와의 연결 계획

권장사항:
- 소규모: /24 (256개 IP)
- 중간규모: /20 (4,096개 IP)
- 대규모: /16 (65,536개 IP)
- 여유분 50% 이상 확보
```

#### Q2: NAT 게이트웨이 비용이 부담스러운데 대안이 있나요?
```
A: NAT 비용 절약 방법:

1. VPC 엔드포인트 활용
   - S3, DynamoDB: Gateway Endpoint (무료)
   - EC2, SSM: Interface Endpoint (유료지만 NAT보다 저렴)

2. NAT 인스턴스 사용
   - 개발/테스트 환경에서 고려
   - t3.nano 등 소형 인스턴스 활용
   - 관리 부담 증가 고려

3. 트래픽 최적화
   - 불필요한 외부 호출 제거
   - 캐싱 활용
   - 배치 처리로 호출 횟수 감소
```

#### Q3: 보안 그룹과 NACL 중 어떤 것을 주로 사용하나요?
```
A: 보안 그룹 중심 설계 권장:

보안 그룹 (주 사용):
- 인스턴스별 세밀한 제어
- Stateful 특성으로 관리 편의
- 다른 보안 그룹 참조 가능

NACL (보조 사용):
- 서브넷 레벨 추가 보안
- 특정 IP 차단 시 유용
- 규정 준수 요구사항

권장 접근법:
1. 보안 그룹으로 기본 보안 설정
2. NACL로 추가 보안 계층 구성
3. 최소 권한 원칙 적용
```

### 추가 학습 리소스

#### 실습 환경 유지 방법
```
비용 절약을 위한 리소스 관리:

매일 실습 후:
- 불필요한 인스턴스 중지
- NAT 게이트웨이 일시 삭제 (필요시 재생성)
- Elastic IP 해제

주말/휴일:
- 모든 인스턴스 중지
- 비용 발생 리소스 정리
- CloudWatch 알림으로 비용 모니터링

실습 재개 시:
- 인스턴스 재시작
- NAT 게이트웨이 재생성
- 라우팅 테이블 업데이트
```

---

## 📝 오늘의 핵심 정리

### VPC 네트워킹 핵심 개념
1. **VPC**: 클라우드의 가상 네트워크, 논리적 격리
2. **서브넷**: 용도별 네트워크 분할 (퍼블릭/프라이빗/DB)
3. **라우팅**: 트래픽 경로 제어, Longest Prefix Match
4. **NAT**: 프라이빗 서브넷의 안전한 외부 통신
5. **연결**: 피어링, Transit Gateway, VPN, Direct Connect

### 설계 원칙
- **계층적 구조**: 보안과 관리 효율성
- **다중 AZ**: 고가용성과 장애 격리
- **최소 권한**: 보안 그룹과 NACL 활용
- **확장성**: 미래 성장을 고려한 CIDR 설계

### 실무 적용 포인트
- **비용 최적화**: VPC 엔드포인트, 적절한 NAT 전략
- **성능 최적화**: 배치 그룹, Enhanced Networking
- **보안 강화**: 다층 보안 모델, 모니터링
- **운영 효율성**: 자동화, 표준화, 문서화

---

## 🎯 내일 학습 준비

### Day 5 예고: VPC 보안 & 종합 정리
- 보안 그룹 vs NACL 심화 학습
- VPC 엔드포인트 실습
- 네트워크 모니터링 (VPC Flow Logs)
- 1주차 종합 정리 및 과제 발표

### 사전 준비사항
- 오늘 구축한 인프라 상태 점검
- 과제 진행 상황 확인
- 궁금한 점 정리

---

> 💡 **오늘의 성취**: VPC 네트워킹의 전체 그림을 이해했습니다! 이제 여러분은 안전하고 확장 가능한 클라우드 네트워크를 설계할 수 있는 기초 지식을 갖추었습니다. 내일은 보안을 더욱 강화하고 모니터링하는 방법을 배워보겠습니다!