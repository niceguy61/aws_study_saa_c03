# AWS 백업 서비스

## 개요
AWS는 데이터 보호, 백업 및 복구를 위한 다양한 서비스를 제공합니다. 이 강의에서는 AWS의 주요 백업 서비스, 백업 전략 설계 방법, 그리고 다양한 AWS 리소스에 대한 백업 및 복원 프로세스를 알아봅니다.

## 학습 목표
- AWS 백업 서비스의 종류와 특징 이해
- AWS Backup을 사용한 중앙 집중식 백업 관리 방법 습득
- 다양한 AWS 리소스에 대한 백업 전략 설계 방법 학습
- 백업 정책, 일정 및 보존 규칙 구성 방법 이해
- 백업 데이터의 보안 및 규정 준수 관리 방법 습득

## AWS 백업 서비스 개요

### AWS Backup
AWS Backup은 AWS 서비스 전반에 걸쳐 데이터 백업을 중앙에서 관리하고 자동화할 수 있는 완전 관리형 서비스입니다.

**주요 기능**:
- 중앙 집중식 백업 관리
- 자동화된 백업 일정
- 백업 정책 및 수명 주기 관리
- 크로스 리전 및 크로스 계정 백업
- 백업 감사 및 보고

**지원되는 AWS 서비스**:
- Amazon EC2
- Amazon EBS
- Amazon RDS
- Amazon Aurora
- Amazon DynamoDB
- Amazon EFS
- Amazon FSx
- AWS Storage Gateway
- Amazon S3
- Amazon DocumentDB
- Amazon Neptune
- Amazon Timestream

**비유**: AWS Backup은 마치 여러 종류의 귀중품(데이터)을 보관하는 중앙 금고 시스템과 같습니다. 모든 귀중품에 대한 보관 규칙, 접근 권한, 보관 기간을 한 곳에서 관리할 수 있습니다.

### 리소스별 네이티브 백업 기능

AWS의 많은 서비스는 자체 백업 기능을 제공하며, 이는 AWS Backup과 함께 사용하거나 독립적으로 사용할 수 있습니다.

#### 1. Amazon EC2/EBS 백업
- **EBS 스냅샷**: 특정 시점의 볼륨 상태 캡처
- **AMI(Amazon Machine Image)**: 인스턴스 구성 및 데이터 캡처
- **스냅샷 수명 주기 관리**: 자동 생성 및 삭제

#### 2. Amazon RDS 백업
- **자동 백업**: 일일 스냅샷 및 트랜잭션 로그 (최대 35일 보존)
- **수동 DB 스냅샷**: 사용자가 시작한 장기 보존 백업
- **특정 시점 복원**: 백업 보존 기간 내 임의 시점으로 복원

#### 3. Amazon S3 백업
- **버전 관리**: 객체의 여러 버전 유지
- **복제**: 리전 간 또는 동일 리전 내 객체 복제
- **S3 Glacier**: 장기 아카이브 스토리지
- **S3 객체 잠금**: WORM(Write Once Read Many) 모델

#### 4. Amazon DynamoDB 백업
- **온디맨드 백업**: 전체 테이블 백업
- **특정 시점 복구(PITR)**: 35일 이내 임의 시점으로 복원
- **AWS Backup 통합**: 장기 보존 및 크로스 리전 백업

## AWS Backup 심층 분석

### 핵심 구성 요소

#### 1. 백업 계획 (Backup Plan)
백업 일정, 백업 윈도우, 수명 주기 규칙 및 백업 볼트를 정의합니다.

**구성 요소**:
- **백업 규칙**: 백업 빈도, 백업 윈도우, 수명 주기 정책
- **리소스 할당**: 백업할 리소스 선택 (태그 기반 또는 개별 리소스)
- **백업 볼트**: 백업 저장소

**예시 백업 계획**:
```
백업 계획: "일일-주간-월간"
  규칙 1: "일일 백업"
    - 빈도: 매일
    - 윈도우: 오전 1시 - 오전 5시
    - 보존 기간: 7일
  규칙 2: "주간 백업"
    - 빈도: 매주 일요일
    - 윈도우: 오전 1시 - 오전 5시
    - 보존 기간: 30일
  규칙 3: "월간 백업"
    - 빈도: 매월 1일
    - 윈도우: 오전 1시 - 오전 5시
    - 보존 기간: 1년
  리소스 할당:
    - 태그: "Environment=Production"
  백업 볼트: "Production-Vault"
```

#### 2. 백업 볼트 (Backup Vault)
백업을 저장하고 구성하는 컨테이너입니다.

**특징**:
- 액세스 정책 및 권한 관리
- 암호화 설정
- 리전별 관리
- 크로스 계정 공유 옵션

**비유**: 백업 볼트는 마치 은행의 안전 금고와 같습니다. 누가 접근할 수 있는지, 어떤 보안 조치가 적용되는지 정의합니다.

#### 3. 복구 시점 (Recovery Point)
특정 시점의 리소스 백업입니다.

**특징**:
- 리소스 유형별 메타데이터
- 상태 정보 (생성 중, 사용 가능, 만료됨 등)
- 수명 주기 정책에 따른 관리

**비유**: 복구 시점은 마치 타임머신의 저장된 시점과 같습니다. 필요할 때 해당 시점으로 돌아갈 수 있습니다.

### AWS Backup 고급 기능

#### 1. 크로스 리전 백업
재해 복구 및 규정 준수를 위해 백업을 다른 AWS 리전에 복사합니다.

**이점**:
- 리전 수준 장애 대응
- 지리적 중복성
- 규제 요구 사항 충족

**구성 방법**:
1. 백업 계획에서 크로스 리전 복사 규칙 추가
2. 대상 리전 및 백업 볼트 지정
3. 대상 리전의 보존 기간 설정

#### 2. 크로스 계정 백업
조직 내 여러 AWS 계정에 걸쳐 백업을 중앙에서 관리합니다.

**이점**:
- 중앙 집중식 백업 관리
- 조직 전체의 일관된 백업 정책
- 백업 관리 책임 분리

**구성 방법**:
1. AWS Organizations 설정
2. 조직 수준에서 AWS Backup 활성화
3. 위임된 관리자 계정 지정
4. 크로스 계정 백업 정책 생성

#### 3. 백업 감사 및 보고
백업 활동을 모니터링하고 규정 준수 요구 사항을 충족합니다.

**기능**:
- AWS Backup Audit Manager
- 백업 작업 상태 모니터링
- 규정 준수 보고서
- CloudTrail과의 통합

**보고서 예시**:
- 백업 작업 성공/실패 비율
- 리소스별 백업 상태
- 규정 준수 상태
- 보존 정책 준수 여부

## 리소스별 백업 전략

### 1. EC2 인스턴스 및 EBS 볼륨 백업

#### 백업 옵션
- **EBS 스냅샷**: 증분식 블록 수준 백업
- **AMI**: 인스턴스 구성 및 연결된 EBS 볼륨 포함
- **AWS Backup**: 중앙 관리 및 자동화

#### 모범 사례
- 애플리케이션 일관성을 위해 스냅샷 전 인스턴스 중지 또는 애플리케이션 정지
- 다중 볼륨 스냅샷 사용
- 태그 기반 백업 정책 구현
- 정기적인 복원 테스트

#### 복원 프로세스
1. 스냅샷에서 새 EBS 볼륨 생성
2. 볼륨을 인스턴스에 연결
3. 또는 AMI에서 새 인스턴스 시작

### 2. RDS 및 Aurora 데이터베이스 백업

#### 백업 옵션
- **자동 백업**: 일일 스냅샷 및 트랜잭션 로그
- **수동 DB 스냅샷**: 장기 보존용
- **AWS Backup**: 중앙 관리 및 크로스 리전 복사

#### 모범 사례
- 적절한 백업 윈도우 설정 (낮은 트래픽 시간)
- 중요 변경 전 수동 스냅샷 생성
- 다중 AZ 배포로 가용성 향상
- 읽기 전용 복제본을 통한 추가 보호

#### 복원 프로세스
1. 스냅샷에서 새 DB 인스턴스 생성
2. 특정 시점으로 복원 (자동 백업 보존 기간 내)
3. 필요한 경우 파라미터 그룹 및 옵션 그룹 조정

### 3. DynamoDB 테이블 백업

#### 백업 옵션
- **온디맨드 백업**: 전체 테이블 백업
- **특정 시점 복구(PITR)**: 35일 이내 복원
- **AWS Backup**: 장기 보존 및 크로스 리전 백업

#### 모범 사례
- PITR 활성화
- 중요 변경 전 온디맨드 백업 생성
- 글로벌 테이블을 통한 리전 중복성
- 정기적인 백업 검증

#### 복원 프로세스
1. 새 테이블로 복원
2. 특정 시점으로 복원 (PITR 활성화된 경우)
3. 필요한 경우 인덱스 및 설정 조정

### 4. S3 데이터 백업

#### 백업 옵션
- **버전 관리**: 객체의 모든 버전 유지
- **복제**: 리전 간 또는 동일 리전 내 복제
- **S3 수명 주기 정책**: 이전 버전 아카이브 또는 삭제
- **AWS Backup**: S3 데이터의 시점 백업

#### 모범 사례
- 버전 관리 및 MFA 삭제 활성화
- 크로스 리전 복제 구성
- 객체 잠금으로 중요 데이터 보호
- 적절한 수명 주기 정책 구현

#### 복원 프로세스
1. 이전 버전 복원 (버전 관리 활성화된 경우)
2. 복제된 버킷에서 복원
3. AWS Backup 복구 시점에서 복원

## 백업 보안 및 규정 준수

### 1. 백업 암호화
백업 데이터를 보호하기 위한 암호화 옵션입니다.

**구성 옵션**:
- AWS KMS 키를 사용한 암호화
- 기본 AWS 관리형 키 또는 고객 관리형 키
- 백업 볼트 수준에서 암호화 설정

**모범 사례**:
- 모든 백업에 암호화 적용
- 중요 데이터에 고객 관리형 키 사용
- 키 교체 및 액세스 정책 정기 검토

### 2. 액세스 제어
백업 및 복원 작업에 대한 권한 관리입니다.

**구성 요소**:
- IAM 정책 및 역할
- 백업 볼트 액세스 정책
- 리소스 기반 정책

**모범 사례**:
- 최소 권한 원칙 적용
- 백업 및 복원 작업 분리
- 중요 백업에 대한 액세스 로깅 활성화

### 3. 규정 준수 관리
백업이 조직의 정책 및 규제 요구 사항을 준수하는지 확인합니다.

**기능**:
- AWS Backup Audit Manager
- 규정 준수 프레임워크 및 제어
- 규정 준수 보고서

**일반적인 제어**:
- 백업 빈도 요구 사항
- 백업 보존 기간
- 백업 암호화
- 크로스 리전 백업

## 백업 비용 최적화

### 1. 스토리지 계층화
백업 데이터의 수명 주기에 따라 다양한 스토리지 클래스를 활용합니다.

**전략**:
- 최근 백업: 표준 스토리지
- 이전 백업: 콜드 스토리지 (S3 Glacier, S3 Glacier Deep Archive)
- 수명 주기 정책을 통한 자동 전환

**비용 절감 예시**:
- S3 Standard: $0.023/GB/월
- S3 Glacier: $0.004/GB/월
- S3 Glacier Deep Archive: $0.00099/GB/월

### 2. 백업 보존 최적화
필요한 기간 동안만 백업을 보존합니다.

**전략**:
- 비즈니스 요구 사항 및 규제 요구 사항 분석
- 계층형 보존 정책 구현 (일일/주간/월간/연간)
- 자동 만료 규칙 설정

**예시 보존 정책**:
- 일일 백업: 7일 보존
- 주간 백업: 4주 보존
- 월간 백업: 12개월 보존
- 연간 백업: 7년 보존

### 3. 증분 백업 활용
변경된 데이터만 백업하여 스토리지 사용량 및 백업 시간을 최소화합니다.

**작동 방식**:
- 첫 번째 백업: 전체 백업
- 이후 백업: 변경된 블록 또는 파일만 백업
- AWS 서비스 대부분이 기본적으로 증분 백업 지원

**이점**:
- 스토리지 비용 절감
- 백업 윈도우 단축
- 네트워크 대역폭 사용 감소

## AWS Backup 구현 단계

### 1. 백업 요구 사항 정의
조직의 백업 요구 사항을 문서화합니다.

**고려 사항**:
- 각 워크로드의 RPO 및 RTO
- 규제 및 규정 준수 요구 사항
- 보존 기간 요구 사항
- 백업 빈도 요구 사항

### 2. 백업 볼트 생성
백업을 저장할 볼트를 생성합니다.

**단계**:
1. AWS Backup 콘솔에서 "백업 볼트" 선택
2. "백업 볼트 생성" 클릭
3. 볼트 이름, 암호화 설정 및 태그 지정
4. 필요한 경우 액세스 정책 구성

### 3. 백업 계획 생성
백업 일정 및 수명 주기 규칙을 정의합니다.

**단계**:
1. AWS Backup 콘솔에서 "백업 계획" 선택
2. "백업 계획 생성" 클릭
3. 백업 규칙 추가 (빈도, 윈도우, 보존 기간)
4. 크로스 리전 복사 규칙 추가 (필요한 경우)
5. 리소스 할당 (태그 기반 또는 개별 리소스)

### 4. 백업 모니터링 및 관리
백업 작업을 모니터링하고 문제를 해결합니다.

**도구**:
- AWS Backup 대시보드
- CloudWatch 지표 및 경보
- AWS Backup Audit Manager
- AWS Config 규칙

### 5. 복원 테스트
정기적으로 백업에서 복원을 테스트합니다.

**모범 사례**:
- 분기별 복원 테스트 수행
- 다양한 시나리오 테스트 (부분 복원, 전체 복원)
- 복원 프로세스 문서화 및 자동화
- 복원 시간 측정 및 개선

## 결론
AWS는 다양한 백업 서비스와 기능을 제공하여 조직의 데이터 보호 요구 사항을 충족할 수 있습니다. AWS Backup을 통해 여러 AWS 서비스에 걸쳐 백업을 중앙에서 관리하고 자동화할 수 있으며, 리소스별 네이티브 백업 기능을 활용하여 특정 요구 사항을 충족할 수 있습니다. 효과적인 백업 전략을 설계하려면 비즈니스 요구 사항을 평가하고, 적절한 백업 빈도 및 보존 정책을 구현하며, 정기적인 복원 테스트를 통해 백업의 유효성을 확인해야 합니다. 백업 보안, 규정 준수 및 비용 최적화를 고려하여 종합적인 데이터 보호 전략을 구축하는 것이 중요합니다.

## 참고 자료
- [AWS Backup 사용 설명서](https://docs.aws.amazon.com/aws-backup/latest/devguide/whatisbackup.html)
- [AWS 백업 및 복구 접근 방식](https://docs.aws.amazon.com/whitepapers/latest/aws-backup-and-recovery-approaches/aws-backup-and-recovery-approaches.html)
- [Amazon RDS 백업 및 복원](https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/CHAP_CommonTasks.BackupRestore.html)
- [Amazon EBS 스냅샷](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/EBSSnapshots.html)
- [Amazon S3 버전 관리](https://docs.aws.amazon.com/AmazonS3/latest/userguide/Versioning.html)