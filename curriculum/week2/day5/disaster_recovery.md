# 재해 복구 전략 및 설계

## 개요
재해 복구(Disaster Recovery, DR)는 자연 재해, 하드웨어 장애, 인적 오류 등으로 인한 시스템 중단 시 비즈니스 연속성을 보장하기 위한 전략과 프로세스입니다. 이 강의에서는 AWS에서 재해 복구 전략을 설계하고 구현하는 방법, 다양한 재해 복구 옵션, 그리고 비즈니스 요구 사항에 맞는 최적의 접근 방식을 선택하는 방법을 알아봅니다.

## 학습 목표
- 재해 복구의 기본 개념과 중요성 이해
- AWS에서 제공하는 다양한 재해 복구 옵션 학습
- RTO(Recovery Time Objective)와 RPO(Recovery Point Objective) 개념 이해
- 비용과 복구 목표 간의 균형을 고려한 재해 복구 전략 설계 방법 습득
- AWS 서비스를 활용한 재해 복구 솔루션 구현 방법 이해

## 재해 복구의 기본 개념

### 재해 복구란?
재해 복구는 예기치 않은 사건으로 인한 IT 인프라 및 시스템의 중단 후 비즈니스 운영을 복원하기 위한 계획 및 프로세스입니다.

**비유**: 재해 복구는 마치 자동차 보험과 같습니다. 사고가 발생하기 전에 준비하지만, 실제로 필요할 때만 사용합니다. 그러나 필요할 때 없다면 심각한 결과를 초래할 수 있습니다.

### 재해 복구의 중요성
- **비즈니스 연속성**: 중단 시간 최소화 및 운영 지속
- **데이터 보호**: 중요 데이터 손실 방지
- **재정적 영향 감소**: 다운타임으로 인한 비용 손실 최소화
- **규제 준수**: 많은 산업에서 재해 복구 계획 요구
- **고객 신뢰**: 서비스 안정성 유지를 통한 신뢰 구축

### 핵심 용어 및 개념

#### 1. RTO (Recovery Time Objective)
서비스 중단 후 비즈니스 프로세스를 복구해야 하는 목표 시간입니다.

**비유**: RTO는 마치 화재 경보가 울린 후 건물을 대피하는 데 걸리는 목표 시간과 같습니다. 이 시간이 짧을수록 더 빠른 대응 체계가 필요합니다.

**예시**:
- 중요 금융 시스템: RTO = 1시간 (1시간 내에 복구 필요)
- 내부 보고 시스템: RTO = 24시간 (24시간 내에 복구 가능)

#### 2. RPO (Recovery Point Objective)
데이터 손실을 허용할 수 있는 최대 기간입니다.

**비유**: RPO는 마치 문서 작업 중 자동 저장 간격과 같습니다. 간격이 짧을수록 잠재적 데이터 손실이 적지만, 더 많은 리소스가 필요합니다.

**예시**:
- 트랜잭션 데이터베이스: RPO = 0 (데이터 손실 없음)
- 분석 데이터베이스: RPO = 24시간 (최대 24시간의 데이터 손실 허용)

#### 3. 가용성 (Availability)
시스템이 정상적으로 작동하는 시간의 비율입니다.

**계산 방법**: (총 시간 - 다운타임) / 총 시간 × 100%

**가용성 수준**:
- 99% (2개의 9) = 연간 약 3.65일 다운타임
- 99.9% (3개의 9) = 연간 약 8.76시간 다운타임
- 99.99% (4개의 9) = 연간 약 52.56분 다운타임
- 99.999% (5개의 9) = 연간 약 5.26분 다운타임

#### 4. 장애 도메인 (Failure Domain)
단일 장애가 영향을 미칠 수 있는 시스템의 부분입니다.

**비유**: 장애 도메인은 마치 배의 격벽과 같습니다. 한 구획에 물이 차도 다른 구획은 안전하게 유지됩니다.

**예시**:
- 가용 영역 (AZ)
- AWS 리전
- 데이터 센터
- 네트워크 세그먼트

## AWS의 재해 복구 옵션

AWS는 다양한 RTO 및 RPO 요구 사항을 충족하기 위한 여러 재해 복구 옵션을 제공합니다.

### 1. 백업 및 복원 (Backup & Restore)
가장 기본적인 DR 전략으로, 정기적인 백업을 생성하고 필요 시 복원합니다.

**작동 방식**:
1. 정기적으로 데이터 및 구성 백업
2. 재해 발생 시 새 인프라 프로비저닝
3. 백업에서 데이터 및 구성 복원
4. DNS 업데이트 및 서비스 재개

**특징**:
- 가장 비용 효율적인 옵션
- 높은 RTO 및 RPO (일반적으로 시간 단위)
- 수동 복구 프로세스 필요
- 비즈니스 크리티컬하지 않은 워크로드에 적합

**AWS 서비스**:
- AWS Backup
- Amazon S3
- Amazon EBS 스냅샷
- Amazon RDS 스냅샷
- AWS DataSync

**비유**: 백업 및 복원은 마치 중요한 문서의 사본을 금고에 보관하는 것과 같습니다. 원본이 손실되면 사본을 꺼내 새로 시작해야 합니다.

### 2. 파일럿 라이트 (Pilot Light)
최소한의 핵심 인프라를 항상 실행하고, 필요 시 완전한 환경으로 확장합니다.

**작동 방식**:
1. 핵심 서비스(주로 데이터베이스)를 DR 환경에서 항상 실행
2. 데이터 복제 유지
3. 재해 발생 시 나머지 인프라 프로비저닝
4. 애플리케이션 서버 시작 및 서비스 재개

**특징**:
- 백업 및 복원보다 빠른 복구
- 중간 수준의 RTO 및 RPO (일반적으로 수십 분 ~ 시간 단위)
- 일부 항상 실행 중인 리소스 필요
- 백업 및 복원보다 높은 비용

**AWS 서비스**:
- Amazon RDS 읽기 전용 복제본
- Amazon EC2 소규모 인스턴스
- AWS CloudFormation
- Amazon Route 53

**비유**: 파일럿 라이트는 마치 보일러의 파일럿 불꽃과 같습니다. 항상 작은 불꽃이 켜져 있어 필요할 때 빠르게 전체 보일러를 가동할 수 있습니다.

### 3. 웜 스탠바이 (Warm Standby)
축소된 규모로 완전히 작동하는 환경을 유지하고, 필요 시 프로덕션 규모로 확장합니다.

**작동 방식**:
1. 축소된 규모로 전체 스택 실행
2. 지속적인 데이터 복제 유지
3. 재해 발생 시 환경을 프로덕션 규모로 확장
4. DNS 업데이트 및 서비스 재개

**특징**:
- 빠른 복구 시간
- 낮은 RTO 및 RPO (일반적으로 분 단위)
- 항상 실행 중인 리소스 필요
- 파일럿 라이트보다 높은 비용

**AWS 서비스**:
- Amazon EC2 Auto Scaling
- Amazon RDS 다중 AZ
- Amazon ElastiCache 복제
- Elastic Load Balancing
- Amazon Route 53

**비유**: 웜 스탠바이는 마치 예비 선수가 벤치에 앉아 있는 것과 같습니다. 이미 유니폼을 입고 워밍업을 마친 상태로, 필요할 때 즉시 경기에 투입될 수 있습니다.

### 4. 멀티 사이트 (Multi-Site) / 핫 스탠바이 (Hot Standby)
프로덕션 환경과 동일한 규모로 완전히 중복된 환경을 유지합니다.

**작동 방식**:
1. 프로덕션과 동일한 규모로 DR 환경 실행
2. 실시간 데이터 복제 유지
3. 재해 발생 시 DR 환경으로 즉시 전환
4. DNS 업데이트 및 서비스 재개

**특징**:
- 가장 빠른 복구 시간
- 최소 RTO 및 RPO (일반적으로 초 ~ 분 단위)
- 완전한 중복 인프라 필요
- 가장 비용이 많이 드는 옵션

**AWS 서비스**:
- AWS Global Accelerator
- Amazon Route 53
- AWS Transit Gateway
- AWS Database Migration Service
- AWS Application Migration Service

**비유**: 멀티 사이트는 마치 쌍둥이 엔진을 가진 비행기와 같습니다. 한 엔진이 고장나도 다른 엔진이 즉시 부하를 감당하여 비행을 계속할 수 있습니다.

### 재해 복구 옵션 비교

| 옵션 | RTO | RPO | 비용 | 복잡성 |
|------|-----|-----|------|--------|
| 백업 및 복원 | 시간 ~ 일 | 시간 ~ 일 | $ | 낮음 |
| 파일럿 라이트 | 수십 분 ~ 시간 | 분 ~ 시간 | $$ | 중간 |
| 웜 스탠바이 | 분 | 초 ~ 분 | $$$ | 높음 |
| 멀티 사이트 | 초 ~ 분 | 초 또는 없음 | $$$$ | 매우 높음 |

## AWS 서비스를 활용한 재해 복구 구현

### 컴퓨팅 리소스 복구

#### 1. Amazon EC2
- **AMI(Amazon Machine Image)**: 인스턴스 구성의 스냅샷
- **EC2 Image Builder**: AMI 생성 및 관리 자동화
- **Auto Scaling**: 장애 인스턴스 자동 교체
- **EC2 Auto Recovery**: 하드웨어 장애 시 인스턴스 자동 복구

#### 2. AWS Elastic Disaster Recovery (DRS)
- 온프레미스 또는 클라우드 워크로드를 AWS로 복구
- 지속적인 데이터 복제
- 최소한의 RPO 및 RTO
- 자동화된 DR 드릴

#### 3. AWS Elastic Beanstalk
- 환경 구성 저장 및 복원
- 블루/그린 배포 지원
- 여러 환경 간 스왑 기능

### 데이터베이스 복구

#### 1. Amazon RDS
- **자동 백업**: 특정 시점으로 복원 가능
- **수동 스냅샷**: 장기 보존용
- **다중 AZ 배포**: 동기식 복제로 자동 장애 조치
- **읽기 전용 복제본**: 비동기식 복제로 읽기 확장 및 DR 지원

#### 2. Amazon DynamoDB
- **온디맨드 백업**: 전체 테이블 백업
- **특정 시점 복구(PITR)**: 35일 이내 복원
- **글로벌 테이블**: 여러 리전에 걸친 다중 마스터 복제

#### 3. Amazon Aurora
- **자동 백업**: 특정 시점으로 복원 가능
- **Aurora 글로벌 데이터베이스**: 리전 간 복제
- **Aurora 다중 마스터**: 여러 쓰기 노드로 고가용성

### 스토리지 복구

#### 1. Amazon S3
- **버전 관리**: 이전 버전의 객체 보존
- **복제**: 리전 간 또는 동일 리전 내 복제
- **S3 객체 잠금**: WORM(Write Once Read Many) 모델
- **S3 수명 주기 정책**: 객체 자동 아카이브 및 삭제

#### 2. Amazon EBS
- **스냅샷**: 특정 시점 볼륨 백업
- **빠른 스냅샷 복원**: 초기화 지연 없이 볼륨 복원
- **다중 볼륨 스냅샷**: 애플리케이션 일관성 보장

#### 3. AWS Storage Gateway
- 온프레미스와 AWS 스토리지 서비스 간 통합
- 파일, 볼륨, 테이프 게이트웨이 옵션
- 로컬 캐싱으로 성능 최적화

### 네트워킹 및 DNS 복구

#### 1. Amazon Route 53
- **상태 확인**: 엔드포인트 상태 모니터링
- **장애 조치 라우팅**: 상태 확인 실패 시 대체 엔드포인트로 라우팅
- **지연 시간 기반 라우팅**: 가장 낮은 지연 시간의 리전으로 라우팅
- **지리적 위치 라우팅**: 사용자 위치 기반 라우팅

#### 2. AWS Global Accelerator
- 글로벌 애니캐스트 IP 주소
- 엣지 로케이션을 통한 트래픽 라우팅
- 상태 확인 및 장애 조치 지원
- 리전 장애 시에도 안정적인 라우팅

#### 3. AWS Transit Gateway
- VPC 및 온프레미스 네트워크 연결
- 리전 간 피어링
- 중앙 집중식 네트워크 아키텍처
- 라우팅 정책 및 보안 제어

### 자동화 및 오케스트레이션

#### 1. AWS CloudFormation
- 인프라를 코드로 정의
- 템플릿 기반 리소스 프로비저닝
- 스택 업데이트 및 롤백
- 크로스 리전 스택 세트

#### 2. AWS Systems Manager
- 자동화 문서 및 런북
- 패치 관리 및 구성 관리
- 인시던트 대응 자동화
- 크로스 계정 및 리전 관리

#### 3. AWS Lambda
- 이벤트 기반 자동화
- 스케줄링된 작업
- 서버리스 워크플로
- 크로스 리전 함수 호출

## 재해 복구 전략 설계

### 비즈니스 요구 사항 평가

#### 1. 워크로드 중요도 분류
- **미션 크리티컬**: 비즈니스 운영에 필수적인 시스템
- **중요**: 단기간 중단은 허용 가능하지만 장기간 중단 시 심각한 영향
- **비크리티컬**: 장기간 중단도 허용 가능한 시스템

#### 2. RTO 및 RPO 정의
- 각 워크로드에 대한 RTO 및 RPO 목표 설정
- 비즈니스 영향 분석 수행
- 규제 및 컴플라이언스 요구 사항 고려

#### 3. 비용 제약 고려
- DR 전략에 할당 가능한 예산
- 운영 오버헤드 및 복잡성
- 비용 대비 위험 분석

### 다중 계층 DR 전략

모든 워크로드에 동일한 DR 전략을 적용하는 대신, 중요도에 따라 다양한 전략을 조합하는 것이 비용 효율적입니다.

**예시**:
- **미션 크리티컬 워크로드**: 멀티 사이트 / 핫 스탠바이
- **중요 워크로드**: 웜 스탠바이 또는 파일럿 라이트
- **비크리티컬 워크로드**: 백업 및 복원

### 리전 선택 고려 사항

#### 1. 지리적 분리
- 자연 재해 위험이 다른 리전 선택
- 물리적 거리 고려
- 지진, 홍수, 허리케인 등의 위험 평가

#### 2. 규제 및 데이터 주권
- 데이터 상주 요구 사항
- 개인 정보 보호 규정
- 산업별 규제 준수

#### 3. 성능 및 지연 시간
- 사용자 기반과의 근접성
- 리전 간 네트워크 지연 시간
- 사용 가능한 서비스 및 기능

### DR 테스트 및 검증

#### 1. 정기적인 DR 훈련
- 시뮬레이션된 장애 시나리오
- 전체 또는 부분 복구 테스트
- 프로세스 및 절차 검증

#### 2. 게임 데이
- 예상치 못한 시나리오에 대한 대응 연습
- 팀 협업 및 의사 소통 테스트
- 개선 영역 식별

#### 3. 자동화된 테스트
- 정기적인 자동 복구 테스트
- 복구 시간 및 데이터 무결성 검증
- 지속적인 개선 및 최적화

## AWS Well-Architected Framework의 재해 복구 관점

AWS Well-Architected Framework의 안정성 기둥은 재해 복구 계획에 대한 지침을 제공합니다.

### 1. 장애로부터의 복구 설계
- 장애 격리를 위한 셀 기반 아키텍처
- 분산 시스템의 복원력 패턴
- 정상 상태로의 자동 복구

### 2. 변경 관리
- 배포 자동화
- 데이터 무결성 보장
- 변경 사항 테스트 및 검증

### 3. 장애 관리
- 장애 감지 및 대응
- 장애 시나리오 시뮬레이션
- 지속적인 개선

## 결론
재해 복구는 비즈니스 연속성을 보장하기 위한 필수적인 요소입니다. AWS는 다양한 RTO 및 RPO 요구 사항을 충족할 수 있는 여러 재해 복구 옵션과 서비스를 제공합니다. 효과적인 재해 복구 전략을 설계하려면 비즈니스 요구 사항을 평가하고, 워크로드 중요도에 따라 적절한 DR 옵션을 선택하며, 정기적인 테스트와 검증을 통해 계획의 효과를 확인해야 합니다. 비용과 복구 목표 사이의 균형을 맞추는 것이 중요하며, 다중 계층 접근 방식을 통해 비용 효율적인 DR 전략을 구현할 수 있습니다.

## 참고 자료
- [AWS 재해 복구 백서](https://docs.aws.amazon.com/whitepapers/latest/disaster-recovery-workloads-on-aws/disaster-recovery-workloads-on-aws.html)
- [AWS Well-Architected Framework - 안정성 기둥](https://docs.aws.amazon.com/wellarchitected/latest/reliability-pillar/welcome.html)
- [AWS 글로벌 인프라](https://aws.amazon.com/about-aws/global-infrastructure/)
- [AWS Elastic Disaster Recovery](https://aws.amazon.com/disaster-recovery/)
- [Amazon Route 53 애플리케이션 복구 컨트롤러](https://aws.amazon.com/route53/application-recovery-controller/)