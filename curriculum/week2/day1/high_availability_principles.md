# 고가용성 설계 원칙

## 개요
고가용성(High Availability, HA)은 시스템이 지속적으로 정상 작동하는 시간을 최대화하는 것을 목표로 하는 설계 원칙입니다. AWS 클라우드에서 고가용성 아키텍처를 구축하는 방법과 핵심 원칙을 알아봅니다.

## 학습 목표
- 고가용성의 개념과 중요성 이해
- AWS에서 고가용성 설계를 위한 핵심 원칙 학습
- 가용성 계산 방법 및 SLA(서비스 수준 계약) 이해
- 고가용성 설계 패턴 및 모범 사례 습득

## 고가용성이란?
고가용성은 시스템이 장애 상황에서도 지속적으로 서비스를 제공할 수 있는 능력을 의미합니다. 일반적으로 연간 가동 시간의 비율로 측정되며, "9의 개수"로 표현됩니다.

### 가용성 수준 예시
- 99% (2개의 9) = 연간 약 3.65일 다운타임
- 99.9% (3개의 9) = 연간 약 8.76시간 다운타임
- 99.99% (4개의 9) = 연간 약 52.56분 다운타임
- 99.999% (5개의 9) = 연간 약 5.26분 다운타임

### 고가용성의 중요성
- **비즈니스 연속성**: 서비스 중단은 수익 손실로 직결
- **사용자 경험**: 서비스 다운타임은 사용자 신뢰 하락
- **데이터 무결성**: 시스템 장애 시 데이터 손실 방지
- **규제 준수**: 많은 산업에서 높은 가용성 요구

## 고가용성을 위한 핵심 원칙

### 1. 단일 장애점(SPOF) 제거
단일 장애점은 해당 구성 요소가 실패할 경우 전체 시스템이 중단되는 지점입니다.

**비유**: 단일 장애점은 마치 한 개의 기둥으로만 지탱되는 건물과 같습니다. 그 기둥이 무너지면 건물 전체가 붕괴됩니다.

**해결 방법**:
- 중요 구성 요소의 중복화
- 여러 가용 영역(AZ) 활용
- 다중 리전 아키텍처 구현

### 2. 안정적인 장애 감지 및 복구
시스템은 장애를 신속하게 감지하고 자동으로 복구할 수 있어야 합니다.

**비유**: 이는 마치 병원의 환자 모니터링 시스템과 같습니다. 문제가 발생하면 즉시 경보가 울리고 의료진이 대응합니다.

**구현 방법**:
- 상태 확인 및 모니터링 시스템 구축
- 자동 복구 메커니즘 구현
- 장애 조치(Failover) 자동화

### 3. 확장성(Scalability)
시스템은 부하 증가에 대응하여 자원을 동적으로 확장할 수 있어야 합니다.

**비유**: 확장성은 교통량에 따라 차선을 늘리거나 줄일 수 있는 스마트 고속도로와 같습니다.

**구현 방법**:
- 수평적 확장(Scale-Out): 인스턴스 수 증가
- 수직적 확장(Scale-Up): 인스턴스 크기 증가
- 자동 확장(Auto Scaling) 구성

### 4. 분산 시스템 설계
워크로드를 여러 리소스에 분산하여 단일 장애의 영향을 최소화합니다.

**비유**: 이는 여러 개의 작은 발전소로 전력망을 구성하는 것과 같습니다. 한 발전소가 고장나도 전체 전력 공급에 미치는 영향이 제한적입니다.

**구현 방법**:
- 마이크로서비스 아키텍처
- 데이터 분산 및 복제
- 지리적 분산

### 5. 내결함성(Fault Tolerance)
시스템의 일부가 실패해도 전체 시스템은 계속 작동할 수 있어야 합니다.

**비유**: 내결함성은 한 타이어가 펑크나도 계속 주행할 수 있는 런플랫 타이어 시스템과 같습니다.

**구현 방법**:
- 중복 구성 요소
- 격리된 장애 도메인
- 우아한 성능 저하(Graceful Degradation)

## AWS에서의 고가용성 구현

### 1. 다중 가용 영역(Multi-AZ) 배포
AWS 가용 영역은 물리적으로 분리된 독립적인 인프라 영역입니다.

**장점**:
- 데이터 센터 수준의 장애 격리
- 낮은 지연 시간으로 연결
- 리전 내 자동 복제

**구현 예시**:
- EC2 인스턴스를 여러 AZ에 배포
- RDS 다중 AZ 구성
- ELB를 통한 여러 AZ의 트래픽 분산

### 2. 다중 리전(Multi-Region) 배포
여러 AWS 리전에 워크로드를 배포하여 리전 수준의 장애에도 대응합니다.

**장점**:
- 리전 수준의 장애 대응
- 지리적 중복성
- 사용자에게 더 가까운 서비스 제공

**구현 예시**:
- Route 53을 사용한 다중 리전 라우팅
- S3 크로스 리전 복제
- DynamoDB 글로벌 테이블

### 3. 자동 복구 및 자가 치유
시스템이 장애를 감지하고 자동으로 복구할 수 있는 메커니즘을 구현합니다.

**구현 예시**:
- EC2 Auto Recovery
- Auto Scaling 그룹
- RDS 자동 장애 조치
- CloudWatch 경보 및 자동화된 대응

### 4. 로드 밸런싱
트래픽을 여러 리소스에 분산하여 단일 지점의 부하를 줄이고 가용성을 높입니다.

**구현 예시**:
- Application Load Balancer
- Network Load Balancer
- Global Accelerator

### 5. 데이터 복제 및 백업
데이터 손실을 방지하고 빠른 복구를 가능하게 합니다.

**구현 예시**:
- S3 버전 관리 및 복제
- RDS 백업 및 스냅샷
- DynamoDB 백업
- AWS Backup 서비스

## 고가용성 설계 패턴

### 1. 액티브-패시브(Active-Passive) 구성
주 시스템(액티브)이 작동하고, 장애 시 대기 시스템(패시브)이 인계받습니다.

**비유**: 이는 마치 주 전원이 끊겼을 때 자동으로 작동하는 비상 발전기와 같습니다.

**구현 예시**:
- RDS 다중 AZ 배포
- EC2 대기 인스턴스

### 2. 액티브-액티브(Active-Active) 구성
모든 시스템이 동시에 작동하며 부하를 분산합니다.

**비유**: 이는 여러 계산대가 동시에 운영되는 대형 마트와 같습니다. 한 계산대에 문제가 생겨도 다른 계산대에서 계속 서비스할 수 있습니다.

**구현 예시**:
- 여러 AZ에 걸친 Auto Scaling 그룹
- 다중 리전 배포

### 3. 서킷 브레이커(Circuit Breaker) 패턴
장애가 발생한 서비스에 대한 요청을 차단하여 연쇄 장애를 방지합니다.

**비유**: 이는 전기 회로의 차단기와 같습니다. 과부하가 발생하면 회로를 차단하여 더 큰 손상을 방지합니다.

**구현 예시**:
- API Gateway 스로틀링
- Lambda 동시성 제한

### 4. 벌크헤드(Bulkhead) 패턴
시스템을 격리된 구획으로 나누어 장애의 확산을 방지합니다.

**비유**: 이는 배의 격벽과 같습니다. 한 구획에 물이 차도 다른 구획은 안전하게 유지됩니다.

**구현 예시**:
- 마이크로서비스 아키텍처
- 리소스 격리

## 고가용성 설계 모범 사례

### 1. 인프라를 코드로 관리(IaC)
- CloudFormation 또는 Terraform을 사용하여 인프라 정의
- 버전 관리 및 자동화된 배포
- 일관된 환경 구성

### 2. 자동화된 테스트 및 배포
- CI/CD 파이프라인 구축
- 자동화된 테스트 및 롤백
- 블루/그린 또는 카나리 배포

### 3. 정기적인 장애 테스트
- 카오스 엔지니어링 원칙 적용
- 계획된 장애 주입
- 복구 절차 검증

### 4. 종합적인 모니터링 및 경보
- CloudWatch 지표 및 경보
- 분산 추적
- 로그 집계 및 분석

### 5. 문서화된 복구 절차
- 장애 시나리오별 대응 계획
- 명확한 에스컬레이션 경로
- 정기적인 훈련 및 업데이트

## 결론
고가용성 설계는 단순히 기술적 구현을 넘어 조직의 문화와 프로세스에도 영향을 미치는 종합적인 접근 방식입니다. AWS는 고가용성 아키텍처를 구축하기 위한 다양한 서비스와 기능을 제공하며, 이를 효과적으로 활용하면 안정적이고 복원력 있는 시스템을 구축할 수 있습니다.

## 참고 자료
- [AWS 고가용성 및 재해 복구 백서](https://docs.aws.amazon.com/whitepapers/latest/disaster-recovery-workloads-on-aws/disaster-recovery-workloads-on-aws.html)
- [AWS Well-Architected Framework - 안정성 기둥](https://docs.aws.amazon.com/wellarchitected/latest/reliability-pillar/welcome.html)
- [AWS 아키텍처 센터 - 고가용성](https://aws.amazon.com/architecture/availability-and-beyond/)