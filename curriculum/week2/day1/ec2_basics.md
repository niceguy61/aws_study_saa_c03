# EC2 기초 및 인스턴스 유형

## 개요
Amazon Elastic Compute Cloud(EC2)는 AWS의 핵심 서비스로, 클라우드에서 가상 서버를 프로비저닝하고 관리할 수 있게 해줍니다. 이 강의에서는 EC2의 기본 개념, 다양한 인스턴스 유형, 그리고 고가용성 설계에서 EC2를 활용하는 방법을 알아봅니다.

## 학습 목표
- EC2의 기본 개념 및 특징 이해
- 다양한 EC2 인스턴스 유형과 사용 사례 학습
- EC2 인스턴스 구매 옵션 비교
- EC2를 활용한 고가용성 아키텍처 설계 방법 습득

## EC2란 무엇인가?

### 기본 개념
Amazon EC2는 AWS 클라우드에서 확장 가능한 컴퓨팅 용량을 제공하는 웹 서비스입니다. EC2를 사용하면 하드웨어에 선투자할 필요가 없어 더 빠르게 애플리케이션을 개발하고 배포할 수 있습니다.

**비유**: EC2는 마치 클라우드에서 빌릴 수 있는 컴퓨터와 같습니다. 필요한 만큼 빌리고, 사용한 만큼만 비용을 지불하며, 더 이상 필요하지 않으면 반납할 수 있습니다.

### EC2의 주요 특징
- **확장성**: 필요에 따라 컴퓨팅 용량을 늘리거나 줄일 수 있음
- **유연성**: 다양한 운영 체제, 인스턴스 유형, 소프트웨어 패키지 선택 가능
- **통합**: 다른 AWS 서비스와 쉽게 통합
- **안정성**: 여러 위치에 인스턴스를 배포하여 장애 대응 가능
- **비용 효율성**: 사용한 만큼만 지불하는 요금 모델

### EC2 관련 주요 개념
- **AMI(Amazon Machine Image)**: 인스턴스를 시작하는 데 필요한 정보를 제공하는 템플릿
- **인스턴스**: AMI에서 시작된 가상 서버
- **인스턴스 유형**: 인스턴스의 CPU, 메모리, 스토리지, 네트워킹 용량을 정의
- **키 페어**: 인스턴스에 안전하게 연결하기 위한 보안 자격 증명
- **보안 그룹**: 인스턴스에 대한 트래픽을 제어하는 가상 방화벽
- **EBS(Elastic Block Store)**: 인스턴스에 연결할 수 있는 영구 스토리지 볼륨
- **태그**: 리소스 관리, 비용 추적 등을 위한 메타데이터

## EC2 인스턴스 유형

EC2 인스턴스 유형은 다양한 사용 사례에 최적화된 여러 조합의 CPU, 메모리, 스토리지 및 네트워킹 용량을 제공합니다. 각 인스턴스 유형은 다양한 크기로 제공되어 워크로드 요구 사항에 맞게 리소스를 확장할 수 있습니다.

### 인스턴스 패밀리

**비유**: 인스턴스 패밀리는 마치 자동차의 종류와 같습니다. 경차, SUV, 트럭 등 각각 다른 용도에 맞게 설계되어 있습니다.

#### 1. 범용 인스턴스 (예: t3, m5)
- **특징**: CPU, 메모리, 네트워킹 리소스의 균형
- **사용 사례**: 웹 서버, 개발 환경, 소규모 데이터베이스
- **비유**: 일반 가정용 승용차와 같이 다양한 용도로 사용 가능

#### 2. 컴퓨팅 최적화 인스턴스 (예: c5, c6g)
- **특징**: 고성능 프로세서, 높은 CPU 대 메모리 비율
- **사용 사례**: 배치 처리, 미디어 트랜스코딩, 고성능 웹 서버, 게임 서버
- **비유**: 스포츠카처럼 속도와 성능에 최적화

#### 3. 메모리 최적화 인스턴스 (예: r5, x1)
- **특징**: 대용량 메모리, 높은 메모리 대 CPU 비율
- **사용 사례**: 인메모리 데이터베이스, 실시간 빅데이터 분석, 캐싱 서버
- **비유**: 대형 화물을 운반할 수 있는 트럭과 같이 많은 데이터를 처리

#### 4. 스토리지 최적화 인스턴스 (예: d2, i3)
- **특징**: 높은 디스크 처리량, 대용량 로컬 스토리지
- **사용 사례**: 데이터 웨어하우스, 분산 파일 시스템, 데이터 처리 애플리케이션
- **비유**: 대형 창고와 같이 많은 물건을 저장하고 빠르게 접근 가능

#### 5. 가속화 컴퓨팅 인스턴스 (예: p3, g4)
- **특징**: 하드웨어 액셀러레이터(GPU, FPGA) 포함
- **사용 사례**: 기계 학습, 고성능 컴퓨팅, 그래픽 렌더링
- **비유**: 특수 장비가 장착된 전문 차량과 같이 특정 작업에 최적화

### 인스턴스 크기 선택 시 고려사항
- **워크로드 요구 사항**: CPU, 메모리, 스토리지, 네트워크 요구 사항 분석
- **성능 요구 사항**: 응답 시간, 처리량, I/O 요구 사항
- **확장 패턴**: 수직 확장(더 큰 인스턴스) vs 수평 확장(더 많은 인스턴스)
- **비용 최적화**: 필요한 성능을 제공하면서 비용 효율적인 옵션 선택

## EC2 인스턴스 구매 옵션

AWS는 다양한 요구 사항과 예산에 맞게 여러 가지 EC2 인스턴스 구매 옵션을 제공합니다.

### 1. 온디맨드 인스턴스
- **특징**: 사용한 시간 또는 초 단위로 비용 지불, 장기 약정 없음
- **장점**: 유연성, 예측 불가능한 워크로드에 적합
- **단점**: 장기적으로는 가장 비싼 옵션
- **사용 사례**: 단기 워크로드, 개발/테스트 환경, 예측 불가능한 애플리케이션
- **비유**: 택시를 타는 것과 같이 필요할 때 바로 이용하고 사용한 만큼 지불

### 2. 예약 인스턴스
- **특징**: 1년 또는 3년 약정으로 온디맨드 대비 최대 72% 할인
- **유형**: 
  - 표준 예약 인스턴스: 가장 큰 할인, 인스턴스 유형 변경 제한적
  - 컨버터블 예약 인스턴스: 중간 수준의 할인, 인스턴스 유형 변경 가능
  - 예약 인스턴스 마켓플레이스: 사용하지 않는 예약 인스턴스 판매/구매
- **사용 사례**: 예측 가능한 워크로드, 장기 프로젝트
- **비유**: 장기 렌터카 계약과 같이 장기간 사용을 약속하고 할인 받음

### 3. 스팟 인스턴스
- **특징**: 미사용 EC2 용량을 온디맨드 대비 최대 90% 할인된 가격에 제공
- **장점**: 가장 비용 효율적인 옵션
- **단점**: AWS가 용량을 회수할 수 있어 중단될 가능성 있음
- **사용 사례**: 내결함성 있는 워크로드, 배치 작업, 데이터 분석, 이미지 처리
- **비유**: 항공사의 대기 승객과 같이 빈 자리가 있을 때 저렴하게 이용 가능하지만 언제든 양보해야 할 수 있음

### 4. 전용 호스트
- **특징**: 물리적 EC2 서버 전체를 독점적으로 사용
- **장점**: 규정 준수 요구 사항 충족, 기존 소프트웨어 라이선스 사용 가능
- **단점**: 가장 비싼 옵션
- **사용 사례**: 라이선스 제약이 있는 소프트웨어, 규제가 엄격한 산업
- **비유**: 건물 전체를 임대하는 것과 같이 전체 리소스를 독점적으로 사용

### 5. Savings Plans
- **특징**: 1년 또는 3년 동안 일정 금액의 시간당 사용량 약정
- **장점**: 유연성과 할인의 균형, EC2, Fargate, Lambda에 적용 가능
- **유형**: 
  - 컴퓨팅 Savings Plans: 가장 유연함, 인스턴스 패밀리, 크기, 리전, OS 변경 가능
  - EC2 인스턴스 Savings Plans: 특정 인스턴스 패밀리에 대해 더 큰 할인
- **사용 사례**: 다양한 컴퓨팅 서비스를 사용하는 조직
- **비유**: 월정액 휴대폰 요금제와 같이 일정 사용량을 약정하고 할인 받음

## EC2를 활용한 고가용성 아키텍처

EC2 인스턴스를 활용하여 고가용성 아키텍처를 구축하는 방법을 알아봅니다.

### 1. 다중 가용 영역(Multi-AZ) 배포
- 여러 가용 영역에 EC2 인스턴스 배포
- 한 가용 영역 장애 시에도 서비스 지속
- Elastic Load Balancer를 사용하여 트래픽 분산

```
[사용자] → [ELB] → [EC2 인스턴스 - AZ-1]
                 → [EC2 인스턴스 - AZ-2]
                 → [EC2 인스턴스 - AZ-3]
```

### 2. Auto Scaling 그룹
- 정의된 조건에 따라 EC2 인스턴스를 자동으로 추가/제거
- 트래픽 증가 시 자동으로 용량 확장
- 장애 인스턴스 자동 교체
- 여러 가용 영역에 걸쳐 인스턴스 분산

### 3. 탄력적 IP 주소
- 인스턴스 장애 시 다른 인스턴스로 IP 주소 재매핑
- 고정 IP 주소가 필요한 애플리케이션에 유용

### 4. Amazon Machine Image(AMI)
- 인스턴스 구성을 템플릿으로 저장
- 장애 발생 시 동일한 구성으로 빠르게 새 인스턴스 시작
- 골든 이미지 전략으로 일관된 환경 유지

### 5. EC2 상태 확인
- 시스템 상태 확인: 기본 하드웨어 및 AWS 네트워크 문제 감지
- 인스턴스 상태 확인: 인스턴스의 소프트웨어/네트워크 구성 문제 감지
- 상태 확인 실패 시 자동 복구 구성 가능

## EC2 관련 모범 사례

### 보안 모범 사례
- 최소 권한 원칙 적용 (보안 그룹, IAM 역할)
- 정기적인 패치 및 업데이트
- 중요 데이터 암호화 (EBS 볼륨, 데이터 전송)
- 키 페어 안전하게 관리
- 네트워크 액세스 제한

### 비용 최적화 모범 사례
- 워크로드에 적합한 인스턴스 유형 선택
- 적절한 구매 옵션 활용 (예약 인스턴스, 스팟 인스턴스)
- 자동 크기 조정으로 사용량에 맞게 용량 조정
- 불필요한 리소스 정리 (유휴 인스턴스, 미연결 EBS 볼륨)
- 비용 모니터링 및 예산 설정

### 성능 최적화 모범 사례
- 워크로드에 맞는 인스턴스 유형 선택
- 향상된 네트워킹 활성화
- 인스턴스 스토어 또는 EBS 최적화 인스턴스 사용
- 배치 그룹을 사용하여 인스턴스 간 지연 시간 최소화
- CloudWatch 지표를 통한 성능 모니터링 및 최적화

### 고가용성 모범 사례
- 여러 가용 영역에 인스턴스 배포
- Auto Scaling 그룹 사용
- 로드 밸런서를 통한 트래픽 분산
- 정기적인 백업 및 복구 절차 테스트
- 장애 시나리오 계획 및 자동화된 복구 메커니즘 구현

## 결론
Amazon EC2는 클라우드에서 가상 서버를 실행하기 위한 핵심 서비스로, 다양한 인스턴스 유형과 구매 옵션을 통해 다양한 워크로드 요구 사항을 충족할 수 있습니다. EC2를 효과적으로 활용하면 확장 가능하고 안정적이며 비용 효율적인 아키텍처를 구축할 수 있습니다. 고가용성 설계 원칙을 EC2에 적용하여 장애에 강한 시스템을 구축하는 것이 중요합니다.

## 참고 자료
- [Amazon EC2 사용 설명서](https://docs.aws.amazon.com/ec2/index.html)
- [EC2 인스턴스 유형](https://aws.amazon.com/ec2/instance-types/)
- [EC2 구매 옵션](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/instance-purchasing-options.html)
- [EC2 모범 사례](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html)